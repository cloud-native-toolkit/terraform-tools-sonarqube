---
# Source: sonarqube/charts/sonarqube/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: sonarqube-sa
---
# Source: sonarqube/charts/sonarqube/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: sonarqube-sonarqube
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
type: Opaque
data:
  postgresql-password: "c29uYXJQYXNz"
---
# Source: sonarqube/charts/tool-config/templates/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: sonarqube-access
  labels:
    helm.sh/chart: tool-config-0.11.2
    app: sonarqube
    release: "sonarqube"
    app.kubernetes.io/part-of: sonarqube
    app.kubernetes.io/component: "tools"
    group: "catalyst-tools"
    grouping: "garage-cloud-native-toolkit"
    app.kubernetes.io/name: sonarqube
    app.kubernetes.io/instance: "sonarqube"
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
  annotations:
    description: Secret to hold the username and password for sonarqube so that other components can access it
type: Opaque
stringData:
  SONARQUBE_URL: "local.service_url"
  SONARQUBE_PASSWORD: "admin"
  SONARQUBE_USER: "admin"
---
# Source: sonarqube/charts/sonarqube/templates/config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-sonarqube-config
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
data:
---
# Source: sonarqube/charts/sonarqube/templates/copy-plugins.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-sonarqube-copy-plugins
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
data:
  copy_plugins.sh: |-
      #!/bin/bash
      for f in /opt/sonarqube/extensions/plugins/tmp/*.jar
      do
        file=${f##*/} && file=${file%-[0-9]*}
        for original in /opt/sonarqube/extensions/plugins/*.jar
        do
          originalfile=${original##*/} && originalfile=${originalfile%-[0-9]*}
          if [ "$originalfile" == "$file" ]; then
            rm -f "$original"
          fi
        done
      done
      cp /opt/sonarqube/extensions/plugins/tmp/*.jar /opt/sonarqube/extensions/plugins/
      exec /opt/sonarqube/bin/run.sh
---
# Source: sonarqube/charts/sonarqube/templates/install-plugins.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-sonarqube-install-plugins
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
data:
  install_plugins.sh: |-
    cd /opt/sonarqube/extensions/plugins/tmp
---
# Source: sonarqube/charts/sonarqube/templates/postgres-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-sonarqube-postgres-config
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
data:
  SONARQUBE_JDBC_USERNAME:  "sonarUser"
  SONARQUBE_JDBC_URL: "jdbc:postgresql://:5432/sonarDB"
---
# Source: sonarqube/charts/sonarqube/templates/tests/test-config.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-sonarqube-tests
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
data:
  run.sh: |-
    @test "Testing Sonarqube UI is accessible" {
      curl --connect-timeout 5 --retry 12 --retry-delay 1 --retry-max-time 60 sonarqube-sonarqube:9000/sessions/new
    }
---
# Source: sonarqube/charts/tool-config/templates/config-map.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: sonarqube-config
  labels:
    helm.sh/chart: tool-config-0.11.2
    app: sonarqube
    release: "sonarqube"
    app.kubernetes.io/part-of: sonarqube
    app.kubernetes.io/component: "tools"
    group: "catalyst-tools"
    grouping: "garage-cloud-native-toolkit"
    app.kubernetes.io/name: sonarqube
    app.kubernetes.io/instance: "sonarqube"
    app.kubernetes.io/version: "1.0"
    app.kubernetes.io/managed-by: Helm
  annotations:
    description: Config map to hold the url for sonarqube in the environment so that other components can access it
data:
  SONARQUBE_URL: "https://-tools-sonarqube."
---
# Source: sonarqube/charts/config-service-account/templates/rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: sonarqube-job-sa
  labels:
    helm.sh/chart: config-service-account-0.6.0
    app.kubernetes.io/name: sonarqube-job-sa
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
rules:
  - apiGroups: ""
    resources:
    - secrets
    - configmaps
    verbs:
    - '*'
---
# Source: sonarqube/charts/config-service-account/templates/rbac.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: sonarqube-job-sa
  labels:
    helm.sh/chart: config-service-account-0.6.0
    app.kubernetes.io/name: sonarqube-job-sa
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: sonarqube-job-sa
subjects:
  - kind: ServiceAccount
    name: sonarqube-job-sa
    namespace: tools-sonarqube
---
# Source: sonarqube/charts/sonarqube/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: sonarqube-sonarqube
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm

spec:
  type: ClusterIP
  ports:
    - port: 9000
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app: sonarqube
    release: sonarqube
---
# Source: sonarqube/charts/sonarqube/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sonarqube-sonarqube
  labels:
    app: sonarqube
    chart: sonarqube-6.6.0
    release: sonarqube
    heritage: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app: sonarqube
      release: sonarqube
  template:
    metadata:
      labels:
        app: sonarqube
        release: sonarqube
        app.kubernetes.io/part-of: sonarqube
      annotations:
        checksum/plugins: 93d52379b10718202a0d61acdae98b65a5fb9c13e2d6fd79bd722759c88829d7
        checksum/config: 890e34f2c9d29bc1318d0ee1c630c6c5c8695433d9cbac9047a0972b445d80b3
        checksum/secret: 6a86d2992399cde5acd7245931d90c3d45f02667e7ab02d4f2c838f761946c7b
    spec:
      serviceAccountName: sonarqube-sa
      securityContext:
        fsGroup: 999
      initContainers:
        - name: init-sysctl
          image: busybox:1.31
          securityContext:
            privileged: true
          command:
          - /bin/sh
          - -c
          - 'if [[ "$(sysctl -n vm.max_map_count)" -lt 262144 ]]; then sysctl -w vm.max_map_count=262144; fi'
      containers:
        - name: sonarqube
          image: "sonarqube:8.2-community"
          imagePullPolicy: Always
          ports:
            - name: http
              containerPort: 9000
              protocol: TCP
          env:
            - name: SONARQUBE_WEB_JVM_OPTS
              value: ""
            - name: SONARQUBE_JDBC_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: sonarqube-sonarqube
                  key: postgresql-password
          envFrom:
            - configMapRef:
                name: sonarqube-sonarqube-postgres-config
          livenessProbe:
            httpGet:
              path: /sessions/new
              port: http
            initialDelaySeconds: 60
            periodSeconds: 30
          readinessProbe:
            httpGet:
              path: /sessions/new
              port: http
            initialDelaySeconds: 60
            periodSeconds: 30
            failureThreshold: 6
          volumeMounts:
            - mountPath: /opt/sonarqube/data
              name: sonarqube
              subPath: data
            - mountPath: /opt/sonarqube/extensions/plugins/tmp
              name: sonarqube
              subPath: tmp
            - mountPath: /opt/sonarqube/extensions/downloads
              name: sonarqube
              subPath: downloads
            - mountPath: /opt/sonarqube/temp
              name: sonarqube
              subPath: temp
            - mountPath: /opt/sonarqube/logs
              name: sonarqube
              subPath: logs
            - mountPath: /tmp
              name: tmp-dir
            - name: copy-plugins
              mountPath: /tmp/scripts
          resources:
            {}
      volumes:
      - name: install-plugins
        configMap:
          name: sonarqube-sonarqube-install-plugins
          items:
            - key: install_plugins.sh
              path: install_plugins.sh
      - name: copy-plugins
        configMap:
          name: sonarqube-sonarqube-copy-plugins
          defaultMode: 0755
          items:
            - key: copy_plugins.sh
              path: copy_plugins.sh
      - name: sonarqube
        emptyDir:
          {}
      - name : tmp-dir
        emptyDir:
          {}
---
# Source: sonarqube/charts/setup-job/templates/job.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: sonarqube-config
  labels:
    helm.sh/chart: setup-job-0.3.0
    app: sonarqube
    app.kubernetes.io/name: sonarqube
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "0.1.0"
    app.kubernetes.io/managed-by: Helm
spec:
    template:
        spec:
            serviceAccountName: sonarqube-job-sa
            initContainers:
              - name: wait-for-sonarqube
                image: quay.io/ibmgaragecloud/alpine-curl
                imagePullPolicy: IfNotPresent
                command: ["sh"]
                args:
                  - "-c"
                  - "until curl -Isf ${URL}; do echo \">>> waiting for ${URL}\"; sleep 90; done; echo \">>> Started\""
                env:
                - name: URL
                  valueFrom:
                    secretKeyRef:
                      key: SONARQUBE_URL
                      name: sonarqube-access
            containers:
                - name: sonarqube-config
                  image: quay.io/ibmgaragecloud/nodejs:latest
                  imagePullPolicy: Always
                  command: ["bash"]
                  args:
                    - "-c"
                    - "npm i -g @ibmgaragecloud/cloud-native-toolkit-web-cli@${CLI_VERSION}; $(npm config get prefix)/bin/igc-web ${COMMAND} --inCluster -n ${NAMESPACE} --debug"
                  env:
                    - name: COMMAND
                      value: setup-sonarqube
                    - name: NAMESPACE
                      valueFrom:
                        fieldRef:
                          fieldPath: metadata.namespace
                    - name: CLI_VERSION
                      value: 0.3.3
            restartPolicy: Never
    backoffLimit: 4
---
# Source: sonarqube/charts/ocp-route/templates/route.yaml
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: sonarqube
  labels:
    app: sonarqube
    console-link.cloud-native-toolkit.dev/enabled: "true"
  annotations:
    console-link.cloud-native-toolkit.dev/enabled: "true"
    console-link.cloud-native-toolkit.dev/section: "Cloud-Native Toolkit"
    console-link.cloud-native-toolkit.dev/imageUrl: "data:image/png;base64,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"
    console-link.cloud-native-toolkit.dev/displayName: "SonarQube"
    console-link.cloud-native-toolkit.dev/category: "code-analysis"
spec:
  to:
    kind: Service
    name: sonarqube-sonarqube
    weight: 100
  port:
    targetPort: http
  tls:
    termination: edge
    insecureEdgeTerminationPolicy: Redirect
  wildcardPolicy: None
---
# Source: sonarqube/charts/config-service-account/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  namespace: tools-sonarqube
  name: sonarqube-job-sa
  annotations:
    "helm.sh/hook": post-install
    "helm.sh/hook-weight": "-5"
  labels:
    helm.sh/chart: config-service-account-0.6.0
    app.kubernetes.io/name: sonarqube-job-sa
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
---
# Source: sonarqube/charts/sonarqube/templates/tests/sonarqube-test.yaml
apiVersion: v1
kind: Pod
metadata:
  name: "sonarqube-ui-test"
  annotations:
    "helm.sh/hook": test-success
  labels:
    app: sonarqube
    chart: sonarqube-1.1.9
    release: sonarqube
    heritage: Helm
spec:
  initContainers:
    - name: "test-framework"
      image: dduportal/bats:0.4.0
      command:
      - "bash"
      - "-c"
      - |
        set -ex
        # copy bats to tools dir
        cp -R /usr/local/libexec/ /tools/bats/
      volumeMounts:
      - mountPath: /tools
        name: tools
  containers:
    - name: sonarqube-ui-test
      image: sonarqube:8.2-community
      command: ["/tools/bats/bats", "-t", "/tests/run.sh"]
      volumeMounts:
      - mountPath: /tests
        name: tests
        readOnly: true
      - mountPath: /tools
        name: tools
  volumes:
  - name: tests
    configMap:
      name: sonarqube-sonarqube-tests
  - name: tools
    emptyDir: 
      {}
  restartPolicy: Never
---
# Source: sonarqube/charts/service-account/templates/scc-anyuid.yaml
apiVersion: security.openshift.io/v1
kind: SecurityContextConstraints
metadata:
  annotations:
    "helm.sh/hook": post-install
    "helm.sh/hook-weight": "-3"
    argocd.argoproj.io/sync-options: Validate=false
    kubernetes.io/description: anyuid provides all features of the restricted SCC
      but allows users to run with any UID and any GID.
  name: tools-sonarqube-sonarqube-sa-anyuid
  labels:
    helm.sh/chart: service-account-0.6.0
    app.kubernetes.io/name: sonarqube-sa
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
allowHostDirVolumePlugin: false
allowHostIPC: false
allowHostNetwork: false
allowHostPID: false
allowHostPorts: false
allowPrivilegeEscalation: true
allowPrivilegedContainer: false
allowedCapabilities: null
defaultAddCapabilities: null
fsGroup:
  type: RunAsAny
groups:
  - system:cluster-admins
priority: 10
readOnlyRootFilesystem: false
requiredDropCapabilities:
  - MKNOD
runAsUser:
  type: RunAsAny
seLinuxContext:
  type: MustRunAs
supplementalGroups:
  type: RunAsAny
users:
  - system:serviceaccount:tools-sonarqube:sonarqube-sa
volumes:
  - configMap
  - downwardAPI
  - emptyDir
  - persistentVolumeClaim
  - projected
  - secret
---
# Source: sonarqube/charts/service-account/templates/scc-privileged.yaml
apiVersion: security.openshift.io/v1
kind: SecurityContextConstraints
metadata:
  annotations:
    "helm.sh/hook": post-install
    "helm.sh/hook-weight": "-3"
    argocd.argoproj.io/sync-options: Validate=false
    kubernetes.io/description: 'privileged allows access to all privileged and host
      features and the ability to run as any user, any group, any fsGroup, and with
      any SELinux context.  WARNING: this is the most relaxed SCC and should be used
      only for cluster administration. Grant with caution.'
  name: tools-sonarqube-sonarqube-sa-privileged
  labels:
    helm.sh/chart: service-account-0.6.0
    app.kubernetes.io/name: sonarqube-sa
    app.kubernetes.io/instance: sonarqube
    app.kubernetes.io/version: "1.16.0"
    app.kubernetes.io/managed-by: Helm
allowHostDirVolumePlugin: true
allowHostIPC: true
allowHostNetwork: true
allowHostPID: true
allowHostPorts: true
allowPrivilegeEscalation: true
allowPrivilegedContainer: true
allowedCapabilities:
  - '*'
allowedUnsafeSysctls:
  - '*'
defaultAddCapabilities: null
fsGroup:
  type: RunAsAny
groups:
  - system:cluster-admins
  - system:nodes
  - system:masters
priority: null
readOnlyRootFilesystem: false
requiredDropCapabilities: null
runAsUser:
  type: RunAsAny
seLinuxContext:
  type: RunAsAny
seccompProfiles:
  - '*'
supplementalGroups:
  type: RunAsAny
users:
  - system:serviceaccount:tools-sonarqube:sonarqube-sa
volumes:
  - '*'
